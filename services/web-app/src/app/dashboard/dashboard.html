<div class="container">
  
  @if (!isLoggedIn) {
    <div class="login-card">
      <h1>üîê PoC Login</h1>
      <p>Simulate authentication to access secure telemetry.</p>
      
      <div class="form-group">
        <input 
          type="text" 
          [(ngModel)]="tenantIdInput" 
          placeholder="Enter Tenant ID (e.g. tenant-001)"
          (keyup.enter)="login()">
      </div>
      
      <button (click)="login()" [disabled]="!tenantIdInput">Access Dashboard</button>
      <div class="hint">Try: <b>tenant-001</b> or <b>tenant-002</b></div>
    </div>
  }

  @if (isLoggedIn) {
    <div class="dashboard-view">
      <header>
        <div class="header-content">
          <div>
            <h1>Dashboard: {{ currentTenant }}</h1>
            <p>End-to-End Encrypted Data Stream</p>
          </div>
          <button class="logout-btn" (click)="logout()">Logout</button>
        </div>
      </header>

      @if (isLoading) {
        <div class="loading">Fetching data...</div>
      }

      @if (!isLoading && telemetryData.length > 0) {
        <table>
          <thead>
            <tr>
              <th>Time</th>
              <th>Gateway</th>
              <th>Decrypted Measurements</th>
            </tr>
          </thead>
          <tbody>
            @for (item of telemetryData; track item.time) {
              <tr>
                <td>{{ item.time | date:'mediumTime' }}</td>
                <td>{{ item.gateway_id }}</td>
                <td class="measurements">{{ formatMeasurements(item.measurements) }}</td>
              </tr>
            }
          </tbody>
        </table>
      }

      @if (!isLoading && telemetryData.length === 0) {
        <div class="empty-state">
          No telemetry found for {{ currentTenant }}.
        </div>
      }
    </div>
  }

</div>